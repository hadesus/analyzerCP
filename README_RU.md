# Программный комплекс «Протокол-Анализатор»

«Протокол-Анализатор» — это веб-приложение, предназначенное для автоматизации процесса извлечения и анализа списков лекарственных средств из документов клинических протоколов с использованием искусственного интеллекта.

## Функциональные возможности

-   **Веб-интерфейс**: Современный и чистый пользовательский интерфейс для загрузки файлов в формате `.docx`.
-   **Анализ на базе ИИ**:
    -   Определение основного заболевания или клинического контекста протокола.
    -   Извлечение полного списка лекарственных препаратов.
    -   Получение англоязычного названия (МНН) для каждого препарата.
    -   Генерация краткого описания роли препарата в лечении.
    -   Оценка уровня доказательности на основе данных, известных ИИ.
-   **Интеграция с PubMed**: Автоматический поиск релевантных клинических исследований и мета-анализов для каждого препарата.
-   **Комплексная отчетность**: Отображение полного анализа в наглядной таблице на веб-странице результатов.
-   **Экспорт в Word**: Возможность скачать итоговый отчет в виде файла `.docx`.

## Установка и запуск

Следуйте этим шагам для локальной установки и запуска проекта.

### 1. Необходимые условия

-   Python 3.7+
-   Ключ API для Google Gemini (см. ниже)

### 2. Установка

1.  **Клонируйте репозиторий:**
    ```bash
    git clone <url-репозитория>
    cd <папка-репозитория>
    ```

2.  **Создайте и активируйте виртуальное окружение (рекомендуется):**
    ```bash
    python3 -m venv venv
    source venv/bin/activate
    # Для Windows используйте: venv\Scripts\activate
    ```

3.  **Установите необходимые зависимости:**
    ```bash
    pip install -r requirements.txt
    ```

### 3. Настройка API ключей

Для работы приложения требуется доступ к API Google Gemini и PubMed.

1.  **Создайте файл `.env`** в корневой директории проекта.
2.  **Добавьте в него ваши ключи:**
    ```
    GEMINI_API_KEY="ВАШ_КЛЮЧ_GEMINI_API"
    PUBMED_API_KEY="ВАШ_КЛЮЧ_PUBMED_API" # Опционально, но рекомендуется
    PUBMED_API_TOOL="ProtocolAnalyzer"
    PUBMED_API_EMAIL="your.email@example.com"
    ```
   - Получите ключ Gemini API из [Google AI Studio](https://aistudio.google.com/app/apikey).
   - Ключ PubMed можно получить из [вашего аккаунта NCBI](https://www.ncbi.nlm.nih.gov/account/).

### 4. Применение миграций базы данных
При первом запуске или после обновления модели данных необходимо применить миграции:
```bash
flask db upgrade
```

## Запуск приложения

После завершения установки вы можете запустить веб-сервер Flask:

```bash
python3 app.py
```

Приложение будет доступно по адресу `http://127.0.0.1:8080`.

## Использование

1.  Откройте ваш веб-браузер и перейдите по адресу `http://127.0.0.1:8080`.
2.  Используйте форму для загрузки файла, чтобы выбрать клинический протокол в формате `.docx`.
3.  Нажмите на кнопку "Анализировать".
4.  Вы будете перенаправлены на страницу результатов, где будет отображена подробная таблица с результатами анализа для каждого найденного препарата.
5.  На странице результатов вы можете нажать на кнопку "Экспорт в Word (.docx)", чтобы скачать отчет в виде документа Word.
