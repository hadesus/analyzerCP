# Программный комплекс «Протокол-Анализатор»

«Протокол-Анализатор» — это веб-приложение, предназначенное для автоматизации процесса извлечения, анализа и верификации списков лекарственных средств из документов клинических протоколов. Система сверяет извлеченные препараты с международными формулярами и данными регуляторных органов для создания всестороннего аналитического отчета.

## Функциональные возможности

-   **Веб-интерфейс**: Современный и чистый пользовательский интерфейс для загрузки файлов в формате `.docx`.
-   **Парсинг `.docx`**: Автоматический поиск и извлечение информации о препаратах из таблиц в документах Word.
-   **NLP-конвейер**:
    -   Анализ сложных строк "способа применения" для извлечения структурированных данных (дозировка, единицы измерения, путь введения, частота).
    -   Стандартизация медицинских терминов к единому формату.
    -   Перевод русских названий МНН на английский язык для запросов к международным базам данных.
-   **Верификация по нескольким источникам**:
    -   Проверка по локальному формуляру, созданному на основе Перечня основных лекарственных средств ВОЗ.
    -   Запросы к веб-сайтам FDA (США) и EMA (Европа) для проверки статуса одобрения.
    -   Поиск в PubMed релевантных клинических исследований и мета-анализов.
-   **Системный Уровень Доказательности (УД)**: Присвоение собственного УД на основе качества данных, найденных в PubMed.
-   **Комплексная отчетность**: Отображение полного анализа в наглядной таблице на веб-странице результатов.
-   **Экспорт в Word**: Возможность скачать итоговый отчет в виде файла `.docx`.

## Установка и запуск

Следуйте этим шагам для локальной установки и запуска проекта.

### 1. Необходимые условия

-   Python 3.7+

### 2. Установка

1.  **Клонируйте репозиторий:**
    ```bash
    git clone <url-репозитория>
    cd <папка-репозитория>
    ```

2.  **Создайте и активируйте виртуальное окружение (рекомендуется):**
    ```bash
    python3 -m venv venv
    source venv/bin/activate
    # Для Windows используйте: venv\Scripts\activate
    ```

3.  **Установите необходимые зависимости:**
    ```bash
    pip install -r requirements.txt
    ```

### 3. Однократная подготовка данных

Приложение использует локальную копию Перечня основных лекарственных средств ВОЗ (WHO EML) для верификации. Вам необходимо сгенерировать этот файл данных, запустив специальный скрипт-парсер. Скрипт скачает официальный PDF-документ с сайта ВОЗ, обработает его и создаст локальный список препаратов.

**Запустите парсер:**
```bash
python3 formulary_parser.py
```
Эта команда создаст файл `who_eml_drug_list.txt` в корневой директории проекта. Этот шаг нужно выполнить только один раз.

## Запуск приложения

После завершения установки вы можете запустить веб-сервер Flask:

```bash
python3 app.py
```

Приложение будет доступно по адресу `http://127.0.0.1:8080`.

## Использование

1.  Откройте ваш веб-браузер и перейдите по адресу `http://127.0.0.1:8080`.
2.  Используйте форму для загрузки файла, чтобы выбрать клинический протокол в формате `.docx`.
3.  Нажмите на кнопку "Анализировать".
4.  Вы будете перенаправлены на страницу результатов, где будет отображена подробная таблица с результатами анализа для каждого найденного препарата.
5.  На странице результатов вы можете нажать на кнопку "Экспорт в Word (.docx)", чтобы скачать отчет в виде документа Word.
